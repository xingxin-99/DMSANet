from scipy.stats import wilcoxon
from statsmodels.stats.multitest import fdrcorrection
import numpy as np
import warnings
warnings.filterwarnings("ignore")

dmsanet_bci_acc = [0.868055556, 0.611111111, 0.927083333, 0.670138889, 0.725694444, 0.708333333, 0.875, 0.850694444, 0.802083333]
fbcsp_bci_acc = [0.795138889, 0.559027778, 0.8125, 0.600694, 0.5069444, 0.399305555, 0.86111, 0.833333, 0.72569]
eeg_bci_acc = [0.777777778, 0.611111111, 0.913194444, 0.680555556, 0.708333333, 0.569444444, 0.722222222, 0.746527778, 0.694444444]
deep_bci_acc =[0.729166667, 0.461805556, 0.802083333, 0.635416667, 0.777777778, 0.572916667, 0.84375, 0.770833333, 0.809027778]
fbc_bci_acc = [0.847222222, 0.5625, 0.909722222, 0.798611111, 0.697916667, 0.548611111, 0.822916667, 0.795138889, 0.798611111]


FBCSP_SVM_OpenBMI = [
    60.00, 58.00, 70.50, 50.00, 49.00, 70.00, 48.50, 55.00, 67.00, 53.50, 46.00, 52.50, 52.00, 52.00, 53.00, 49.50, 46.00, 79.00,
    72.00, 55.50, 97.00, 59.50, 58.00, 47.50, 51.50, 46.00, 52.50, 89.00, 93.00, 57.50, 53.50, 78.00, 92.00, 50.50, 79.00, 94.00,
    89.50, 48.50, 53.00, 52.00, 54.00, 55.50, 51.50, 96.00, 82.50, 50.50, 56.50, 51.00, 47.50, 51.50, 52.50, 51.50, 49.50, 52.00
]
DeepConvNet_OpenBMI = [
    61.00, 67.50, 92.00, 58.00, 84.50, 72.50, 46.50, 56.50, 74.50, 56.00, 45.00, 51.00, 53.50, 54.00, 54.00, 52.00, 57.00, 86.00,
    85.00, 49.50, 98.50, 78.50, 61.50, 57.00, 63.00, 53.50, 54.00, 95.50, 91.50, 54.00, 51.00, 83.00, 92.00, 50.50, 75.50, 96.50,
    94.50, 51.00, 65.50, 53.50, 50.50, 51.50, 57.00, 96.00, 86.50, 55.00, 54.00, 57.00, 56.50, 46.00, 52.50, 61.50, 49.50, 49.50
]
EEGNet_OpenBMI =  [
    83.50, 64.50, 94.50, 63.50, 86.00, 81.00, 55.00, 61.00, 77.50, 65.00, 61.00, 61.50, 58.00, 57.00, 63.00, 52.00, 53.00, 87.00,
    74.00, 67.00, 94.50, 77.00, 54.50, 55.00, 64.50, 62.50, 59.50, 93.00, 92.00, 60.00, 57.50, 84.00, 96.00, 46.50, 68.00, 96.50,
    92.50, 54.50, 54.00, 54.50, 54.50, 50.50, 65.50, 97.50, 94.00, 61.00, 47.00, 54.00, 68.50, 51.00, 55.00, 67.50, 58.00, 54.50
]

EEG_Inception_OpenBMI =  [
    65.00, 66.00, 92.00, 57.00, 74.00, 82.00, 50.50, 61.00, 73.50, 66.50, 53.50, 66.50, 53.00, 56.00, 60.00, 51.00, 69.50, 83.00,
    73.50, 62.50, 98.50, 65.50, 66.50, 53.00, 67.50, 53.00, 48.50, 82.00, 94.50, 61.50, 56.50, 87.00, 94.00, 51.00, 80.00, 97.00,
    89.00, 50.00, 70.50, 60.50, 50.00, 53.00, 67.50, 94.50, 87.50, 62.50, 48.50, 60.00, 58.00, 56.00, 58.00, 67.00, 58.50, 57.50
]


FBCNet_OpenBMI = [
    81.50, 79.00, 96.00, 65.00, 89.00, 83.00, 66.00, 63.50, 74.00, 65.50, 54.00, 63.00, 57.50, 53.50, 52.50, 56.00, 69.50, 76.50,
    66.50, 65.00, 98.50, 72.00, 57.50, 54.00, 65.00, 53.50, 54.50, 95.50, 93.00, 66.50, 49.50, 83.00, 95.50, 48.00, 68.00, 98.00,
    92.50, 51.00, 84.00, 53.50, 55.50, 59.00, 71.50, 97.50, 92.00, 72.50, 56.00, 51.00, 62.00, 52.00, 56.00, 74.50, 56.00, 50.00
]

DMSANet_OpenBMI =  [
    87.50, 67.50, 97.50, 64.50, 94.50, 88.50, 69.00, 57.50, 80.50, 65.50, 54.00, 74.50, 49.50, 69.00, 60.00, 57.00, 59.50, 76.00,
    80.50, 73.00, 100.00, 73.00, 67.00, 54.50, 62.00, 54.50, 51.50, 98.00, 88.50, 66.50, 67.50, 89.00, 98.00, 50.50, 70.00, 96.00,
    96.00, 56.00, 80.50, 58.50, 54.00, 66.00, 83.00, 99.00, 91.50, 66.50, 56.00, 57.50, 64.50, 53.00, 57.00, 72.00, 55.00, 50.50
]
# 计算与dmsanet的p值
p_values = []
for acc in [FBCSP_SVM_OpenBMI, DeepConvNet_OpenBMI, EEGNet_OpenBMI, EEG_Inception_OpenBMI ,FBCNet_OpenBMI ]:
    _, p_value = wilcoxon(acc, DMSANet_OpenBMI)
    p_values.append(p_value)

# 进行FDR检验
rejected, corrected_p_values = fdrcorrection(p_values)

print('p-values:', p_values)
print('corrected p-values:', corrected_p_values)
print('rejected:', rejected)
